Projet CloudShop - Guide de D√©ploiement CompletCe document permet de d√©ployer l'int√©gralit√© de l'infrastructure CloudShop de mani√®re autonome, de la cr√©ation du cluster jusqu'aux tests de validation.

üèóÔ∏è 1. Cr√©ation du Cluster KindLe cluster est compos√© de 1 Control-Plane et 3 Workers pour permettre une isolation r√©elle.

Commande : 
- kind create cluster --config kind-config.yaml --name cloudshop-cluster

üõ°Ô∏è 2. Installation du R√©seau et de la S√©curit√© (CNI Calico)Par d√©faut, Kind ne g√®re pas les NetworkPolicies. Il faut installer Calico pour que le "pare-feu" fonctionne.

COMMANDES (l'une apr√®s l'autre) :
- kubectl apply -f 
- kubectl delete pods -n kube-system -l k8s-app=kindnet

üöÄ 3. D√©ploiement de l'InfrastructureIl est crucial de respecter cet ordre pour que les ressources se lient correctement.

COMMANDES : 
- Cr√©ation Namespace : kubectl create namespace cloudshopStockage
- Stocakge Persistant : kubectl apply -f storage/
- Droits d'acc√®s (RBAC) : kubectl apply -f rbac/Pare-feu 
- Pare-feu (NetworkPolicies) : kubectl apply -f networkpolicy/
- Exposition (Services) : kubectl apply -f services/
- Applications (Deployments) : kubectl apply -f deployments/
- Routage Externe (Ingress) : kubectl apply -f ingress/

üß™ 4. Tests de Validation 

A. Test de S√©curit√© (Doit afficher "Connection timed out")

Le Frontend ne peut pas attaquer la base de donn√©es en direct.

COMMANDE :
kubectl exec -it $(kubectl get pod -l tier=frontend -n cloudshop -o name | head -n 1) -n cloudshop -- curl --connect-timeout 2 db-service:3306

B. Test de Persistance (Survie des donn√©es)

Il faut supprimer le pod de la base de donn√©es et v√©rifier que les donn√©es reviennent.

COMMANDES :

- Supprimer le pod : kubectl delete pod -l app=database -n cloudshop
- V√©rifier les bases apr√®s 10 secondes : kubectl exec -it $(kubectl get pod -l app=database -n cloudshop -o name) -n cloudshop -- bash -c 'mysql -u root -p$MYSQL_ROOT_PASSWORD -e "SHOW DATABASES;"'

C. Test de Droits (RBAC)

On v√©rifie que le backend a uniquement les droits n√©cessaires.

COMMANDES :
- Test de lecture (Doit dire YES) : kubectl auth can-i get pods --as=system:serviceaccount:cloudshop:backend-sa -n cloudshop
- Test de destruction (Doit dire NO) : kubectl auth can-i delete nodes --as=system:serviceaccount:cloudshop:backend-sa

üåê 5. Acc√®s au Site WebPour ouvrir le site CloudShop sur ton navigateur Windows :
COMMANDE : 
- kubectl port-forward svc/frontend-service -n cloudshop 8080:80

URL √Ä OUVRIR :http://localhost:8080

Auteur : Louis GAUTIER